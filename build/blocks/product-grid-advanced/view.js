!function(){"use strict";document.addEventListener("change",function(e){if(!e.target.matches(".wcba-sort-select"))return;const t=e.target,r=t.getAttribute("data-block-id"),[a,n]=t.value.split("|");if(!document.getElementById(r))return;const c=new URL(window.location.href);c.searchParams.set("orderby",a),c.searchParams.set("order",n),window.location.href=c.toString()}),document.addEventListener("click",function(e){if(e.target.matches(".wcba-filter-apply")){e.preventDefault();const t=e.target.closest(".wcba-grid-filters");if(!t)return;t.getAttribute("data-block-id");const r=new URL(window.location.href),a=t.querySelector('[data-filter="category"]');if(a&&a.selectedOptions.length>0){const e=Array.from(a.selectedOptions).map(e=>e.value);r.searchParams.set("filter_cat",e.join(","))}const n=t.querySelector('[data-filter="price_min"]')?.value,c=t.querySelector('[data-filter="price_max"]')?.value;n&&r.searchParams.set("filter_price_min",n),c&&r.searchParams.set("filter_price_max",c);const o=t.querySelector('[data-filter="rating"]');o&&o.value&&r.searchParams.set("filter_rating",o.value);const i=t.querySelector('[data-filter="stock"]');i&&i.checked&&r.searchParams.set("filter_stock","instock"),window.location.href=r.toString()}if(e.target.matches(".wcba-filter-reset")){e.preventDefault();const t=new URL(window.location.href);["filter_cat","filter_price_min","filter_price_max","filter_rating","filter_stock"].forEach(e=>{t.searchParams.delete(e)}),window.location.href=t.toString()}}),document.addEventListener("click",function(e){if(!e.target.matches(".wcba-loadmore-btn"))return;e.preventDefault();const t=e.target,r=parseInt(t.getAttribute("data-page"),10),a=parseInt(t.getAttribute("data-max"),10),n=r+1,c=t.closest(".wcba-product-grid-advanced")?.id;if(!c)return;t.disabled=!0,t.textContent=t.textContent+"...";const o=new URL(window.location.href);o.searchParams.set("paged",n),o.searchParams.set("action","wcba_load_more_products"),o.searchParams.set("block_id",c),fetch(o.toString()).then(e=>e.json()).then(e=>{if(e.success&&e.data.html){const r=document.querySelector(`#${c} .wcba-product-grid`);r&&(r.insertAdjacentHTML("beforeend",e.data.html),n>=a?t.parentElement.remove():(t.setAttribute("data-page",n),t.disabled=!1,t.textContent=t.textContent.replace("...","")))}}).catch(e=>{console.error("Load more error:",e),t.disabled=!1,t.textContent=t.textContent.replace("...","")})});let e=null;"IntersectionObserver"in window&&(e=new IntersectionObserver(function(e){e.forEach(e=>{if(e.isIntersecting){const t=e.target.querySelector(".wcba-loadmore-btn");t&&!t.disabled&&t.click()}})},{rootMargin:"100px"}),document.querySelectorAll('.wcba-product-grid-advanced[data-infinite="true"] .wcba-grid-loadmore').forEach(t=>{e.observe(t)}))}();